<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pok√©mon ¬∑ Combate cl√°sico</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Courier New', Courier, monospace;
            user-select: none;
        }

        body {
            background: linear-gradient(145deg, #1a2f3f 0%, #0b1a26 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
            padding: 16px;
        }

        .gameboy {
            max-width: 700px;
            width: 100%;
            background: #9bbc7f;
            background: #8bac7f;
            border-radius: 30px 30px 20px 20px;
            box-shadow: 0 20px 0 #4a5c3f, 0 30px 20px rgba(0,0,0,0.5);
            padding: 25px 20px 35px;
            border-bottom: 6px solid #6a7c5f;
        }

        .screen {
            background: #9bb87f;
            background: #a0c080;
            border-radius: 20px 20px 15px 15px;
            padding: 20px 15px 15px;
            border: 5px solid #5e6f4e;
            box-shadow: inset 0 -5px 0 #4a5a3a, inset 0 5px 5px #d0e0a0;
            margin-bottom: 25px;
        }

        .battle-panel {
            display: flex;
            justify-content: space-between;
            margin-bottom: 25px;
            gap: 15px;
        }

        .pokemon-card {
            background: #f0f8e0;
            border-radius: 18px 18px 12px 12px;
            padding: 15px 10px 10px;
            flex: 1;
            box-shadow: inset -2px -2px 0 #6d7f5a, inset 2px 2px 0 #ffffe0, 0 5px 0 #4f6140;
            border: 2px solid #3f5130;
            position: relative;
        }

        .pokemon-card.opponent {
            background: #f0d8b0;
        }

        .pokemon-name {
            font-size: 1.4rem;
            font-weight: bold;
            letter-spacing: 1px;
            color: #1f2f1f;
            text-shadow: 2px 2px 0 #b0c090;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .hp-bar-container {
            background: #59423b;
            border-radius: 30px;
            padding: 3px;
            border: 2px solid #3a2a23;
            box-shadow: inset 0 1px 3px #2d1e19;
            margin-bottom: 6px;
        }

        .hp-bar {
            background: #2e9c4b;
            height: 18px;
            border-radius: 20px;
            width: 100%;
            transition: width 0.2s ease;
            box-shadow: inset 0 2px 5px #8fec8f, 0 2px 0 #1a6b2a;
        }

        .hp-text {
            font-size: 1.1rem;
            font-weight: bold;
            color: #202820;
            background: #b8d098;
            padding: 2px 8px;
            border-radius: 20px;
            display: inline-block;
            border: 2px solid #4e6b3e;
        }

        .sprite {
            font-size: 4rem;
            line-height: 1;
            text-align: center;
            margin: 5px 0;
            filter: drop-shadow(4px 4px 0 #3f5130);
        }

        .message-box {
            background: #284030;
            border-radius: 30px;
            padding: 18px 20px;
            border: 4px solid #4f6940;
            box-shadow: inset 0 0 0 3px #1f2f1f, inset 0 0 0 5px #3b553b;
            color: #c0f0b0;
            font-size: 1.2rem;
            font-weight: bold;
            min-height: 100px;
            margin-bottom: 20px;
            overflow-y: auto;
            max-height: 120px;
            line-height: 1.4;
            text-shadow: 2px 2px 0 #0f1f0f;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
        }

        .btn {
            background: #284030;
            border: none;
            border-radius: 60px;
            padding: 15px 25px;
            font-size: 1.5rem;
            font-weight: bold;
            color: #e0f0c0;
            box-shadow: 0 6px 0 #0f2a0f, 0 8px 8px rgba(0,0,0,0.6);
            cursor: pointer;
            transition: all 0.07s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            flex: 1 0 140px;
            border: 2px solid #6f9f4f;
        }

        .btn:active {
            transform: translateY(6px);
            box-shadow: 0 2px 0 #0f2a0f, 0 5px 8px rgba(0,0,0,0.5);
        }

        .btn:disabled {
            opacity: 0.5;
            transform: translateY(3px);
            box-shadow: 0 3px 0 #1f3a1f;
            pointer-events: none;
            filter: grayscale(0.7);
        }

        .btn.run {
            background: #5a4030;
            box-shadow: 0 6px 0 #3a2a1a;
            border-color: #b08060;
        }

        .btn.reset {
            background: #306080;
            box-shadow: 0 6px 0 #103050;
            border-color: #70a0d0;
            flex: 0.4;
        }

        .divider {
            font-size: 2.5rem;
            align-self: center;
            color: #2f3f1f;
            text-shadow: 2px 2px 0 #a0b880;
        }

        .vs {
            font-size: 2rem;
            font-weight: bold;
            background: #c02828;
            color: #f8d878;
            padding: 5px 15px;
            border-radius: 40px;
            border: 3px solid #f0c060;
            transform: rotate(-5deg);
            box-shadow: 0 5px 0 #701818;
        }

        footer {
            text-align: center;
            margin-top: 15px;
            color: #2c3a1c;
            font-weight: bold;
            font-size: 1.2rem;
            text-shadow: 1px 1px 0 #b0d090;
        }
    </style>
</head>
<body>
<div class="gameboy">
    <div class="screen">
        <!-- √Årea de combate -->
        <div class="battle-panel">
            <!-- Pok√©mon del jugador (izquierda) -->
            <div class="pokemon-card" id="playerCard">
                <div class="pokemon-name">
                    <span>‚ö°</span> PIKACHU
                </div>
                <div class="sprite" id="playerSprite">‚ö°‚ö°<br> (·µî·¥•·µî)</div>
                <div class="hp-bar-container">
                    <div class="hp-bar" id="playerHpBar" style="width: 100%;"></div>
                </div>
                <div class="hp-text" id="playerHpText">100/100</div>
            </div>

            <div class="vs">VS</div>

            <!-- Pok√©mon rival (derecha) -->
            <div class="pokemon-card opponent" id="opponentCard">
                <div class="pokemon-name">
                    <span>üî•</span> CHARMANDER
                </div>
                <div class="sprite" id="opponentSprite">üî•üî•<br> („ÜÅœâ„ÜÅ)</div>
                <div class="hp-bar-container">
                    <div class="hp-bar" id="opponentHpBar" style="width: 100%;"></div>
                </div>
                <div class="hp-text" id="opponentHpText">80/80</div>
            </div>
        </div>

        <!-- Caja de mensajes (como en los juegos Game Boy) -->
        <div class="message-box" id="messageBox">
            > ¬°Un Charmander salvaje apareci√≥!
        </div>

        <!-- Botones de acci√≥n -->
        <div class="controls">
            <button class="btn" id="attack1" data-move="0">‚ö° THUNDERBOLT</button>
            <button class="btn" id="attack2" data-move="1">üí® QUICK ATTACK</button>
            <button class="btn run" id="runBtn">üèÉ RUN</button>
            <button class="btn" id="itemBtn">üéí ITEM</button>
            <button class="btn reset" id="resetBtn">‚Üª RESET</button>
        </div>
    </div>
    <footer>‚ú¶ COMBATE POR TURNOS ‚ú¶</footer>
</div>

<script>
    (function() {
        // ----- estado del juego -----
        const player = {
            name: 'Pikachu',
            maxHp: 100,
            currentHp: 100,
            attacks: [
                { name: 'Thunderbolt', minDmg: 20, maxDmg: 30 },
                { name: 'Quick Attack', minDmg: 10, maxDmg: 20 }
            ]
        };

        const opponent = {
            name: 'Charmander',
            maxHp: 80,
            currentHp: 80,
            attacks: [
                { name: 'Ember', minDmg: 15, maxDmg: 25 },
                { name: 'Scratch', minDmg: 8, maxDmg: 18 }
            ]
        };

        // control de turnos: true = puede atacar el jugador, false = turno del rival (o fin)
        let playerTurn = true;
        let gameActive = true; // false si alguien ya debilit√≥
        let actionInProgress = false; // bloquea doble click

        // elementos DOM
        const playerHpBar = document.getElementById('playerHpBar');
        const opponentHpBar = document.getElementById('opponentHpBar');
        const playerHpText = document.getElementById('playerHpText');
        const opponentHpText = document.getElementById('opponentHpText');
        const messageBox = document.getElementById('messageBox');
        const attack1 = document.getElementById('attack1');
        const attack2 = document.getElementById('attack2');
        const runBtn = document.getElementById('runBtn');
        const itemBtn = document.getElementById('itemBtn');
        const resetBtn = document.getElementById('resetBtn');
        const playerSprite = document.getElementById('playerSprite');
        const opponentSprite = document.getElementById('opponentSprite');

        // ----- funciones auxiliares -----
        function logMessage(msg) {
            // mantener √∫ltimas 3 l√≠neas aprox
            let html = messageBox.innerHTML;
            let newEntry = '> ' + msg;
            // simple: a√±adir al principio o reemplazar? lo haremos tipo feed
            // dividimos por <br> o saltos
            let lines = html.split('<br>');
            if (lines.length > 4) lines.pop(); // limitar a 4 l√≠neas
            lines.unshift(newEntry);
            messageBox.innerHTML = lines.join('<br>');
        }

        function updateHpBars() {
            // jugador
            let playerPercent = (player.currentHp / player.maxHp) * 100;
            playerHpBar.style.width = Math.max(0, playerPercent) + '%';
            playerHpText.innerText = `${player.currentHp}/${player.maxHp}`;

            // rival
            let opponentPercent = (opponent.currentHp / opponent.maxHp) * 100;
            opponentHpBar.style.width = Math.max(0, opponentPercent) + '%';
            opponentHpText.innerText = `${opponent.currentHp}/${opponent.maxHp}`;

            // cambiar color de barras si bajo (opcional)
            if (player.currentHp < player.maxHp * 0.2) {
                playerHpBar.style.background = '#d43f3f';
            } else {
                playerHpBar.style.background = '#2e9c4b';
            }
            if (opponent.currentHp < opponent.maxHp * 0.2) {
                opponentHpBar.style.background = '#d43f3f';
            } else {
                opponentHpBar.style.background = '#2e9c4b';
            }

            // sprites animicos (opcional)
            if (player.currentHp <= 0) {
                playerSprite.innerHTML = '‚úñ‚úñ<br> (x_x)';
            } else {
                playerSprite.innerHTML = '‚ö°‚ö°<br> (·µî·¥•·µî)';
            }
            if (opponent.currentHp <= 0) {
                opponentSprite.innerHTML = '‚ùå‚ùå<br> (Ôºõ‰∏Ä_‰∏Ä)';
            } else {
                opponentSprite.innerHTML = 'üî•üî•<br> („ÜÅœâ„ÜÅ)';
            }
        }

        function disableAllActions(disabled = true) {
            attack1.disabled = disabled;
            attack2.disabled = disabled;
            runBtn.disabled = disabled;
            itemBtn.disabled = disabled;
        }

        function checkGameOver() {
            if (player.currentHp <= 0) {
                gameActive = false;
                playerTurn = false;
                disableAllActions(true);
                logMessage('¬°Pikachu se debilit√≥! ... ¬°Fin del combate!');
                return true;
            } else if (opponent.currentHp <= 0) {
                gameActive = false;
                playerTurn = false;
                disableAllActions(true);
                logMessage('¬°Charmander se debilit√≥! ¬°Has ganado!');
                return true;
            }
            return false;
        }

        // ataque del rival (IA simple)
        function opponentAttack() {
            if (!gameActive) return;
            if (opponent.currentHp <= 0) {
                checkGameOver();
                return;
            }

            // elige ataque aleatorio
            const attackIdx = Math.floor(Math.random() * opponent.attacks.length);
            const attack = opponent.attacks[attackIdx];
            const damage = Math.floor(Math.random() * (attack.maxDmg - attack.minDmg + 1)) + attack.minDmg;

            player.currentHp = Math.max(0, player.currentHp - damage);
            logMessage(`üî• Charmander us√≥ ${attack.name} y caus√≥ ${damage} de da√±o.`);

            updateHpBars();

            if (checkGameOver()) {
                // si el jugador cay√≥, no habilitar turno
                return;
            }

            // despu√©s del ataque rival, turno del jugador
            playerTurn = true;
            actionInProgress = false;
            disableAllActions(false); // habilitamos botones (excepto si gameover)
            if (!gameActive) disableAllActions(true);
        }

        // ataque del jugador
        function playerAttack(attackIndex) {
            if (!gameActive || !playerTurn || actionInProgress) return;
            if (player.currentHp <= 0 || opponent.currentHp <= 0) {
                checkGameOver();
                return;
            }

            actionInProgress = true;
            playerTurn = false; // bloquea nuevo ataque hasta turno rival
            disableAllActions(true); // deshabilita durante proceso

            const attack = player.attacks[attackIndex];
            const damage = Math.floor(Math.random() * (attack.maxDmg - attack.minDmg + 1)) + attack.minDmg;

            opponent.currentHp = Math.max(0, opponent.currentHp - damage);
            logMessage(`‚ö° Pikachu us√≥ ${attack.name} y caus√≥ ${damage} de da√±o.`);

            updateHpBars();

            if (checkGameOver()) {
                actionInProgress = false; // partido terminado, no sigue rival
                return;
            }

            // turno del rival despu√©s de 1 segundo (efecto de juego por turnos)
            setTimeout(() => {
                if (gameActive) {
                    opponentAttack();
                } else {
                    // si por alg√∫n motivo el juego termin√≥ durante el timeout
                    disableAllActions(true);
                }
            }, 1000);
        }

        // intentar huir
        function attemptRun() {
            if (!gameActive || !playerTurn || actionInProgress) return;
            actionInProgress = true;
            playerTurn = false;
            disableAllActions(true);

            const escapeChance = 0.5; // 50%
            if (Math.random() < escapeChance) {
                logMessage('¬°Huiste sin problemas! ... (el combate termina)');
                gameActive = false;
                disableAllActions(true);
                // no m√°s acciones
            } else {
                logMessage('¬°No pudiste escapar!');
                // el rival ataca inmediatamente (sin esperar)
                // pero debemos esperar un poco para que se lea el mensaje
                setTimeout(() => {
                    if (gameActive) {
                        opponentAttack();
                    } else {
                        disableAllActions(true);
                    }
                }, 800);
            }
            updateHpBars();
        }

        // item simulado
        function useItem() {
            if (!gameActive || !playerTurn || actionInProgress) return;
            logMessage('¬°No tienes objetos! Es mejor atacar.');
            // no consume turno? para mantener simple, pierdes el turno (como en algunos pok√©mon)
            // pero daremos un mensaje y perder√°s el turno igual
            actionInProgress = true;
            playerTurn = false;
            disableAllActions(true);

            setTimeout(() => {
                if (gameActive) {
                    logMessage('El rival aprovecha para atacar...');
                    opponentAttack();
                } else {
                    disableAllActions(true);
                }
            }, 900);
        }

        // reset completo
        function resetGame() {
            // restaurar valores
            player.currentHp = player.maxHp;
            opponent.currentHp = opponent.maxHp;
            playerTurn = true;
            gameActive = true;
            actionInProgress = false;

            updateHpBars();
            // limpiar mensajes
            messageBox.innerHTML = '> ¬°Un Charmander salvaje apareci√≥!';
            // habilitar botones
            disableAllActions(false);
            // sprite normal
            playerSprite.innerHTML = '‚ö°‚ö°<br> (·µî·¥•·µî)';
            opponentSprite.innerHTML = 'üî•üî•<br> („ÜÅœâ„ÜÅ)';
        }

        // ----- eventos -----
        attack1.addEventListener('click', () => playerAttack(0));
        attack2.addEventListener('click', () => playerAttack(1));
        runBtn.addEventListener('click', attemptRun);
        itemBtn.addEventListener('click', useItem);
        resetBtn.addEventListener('click', resetGame);

        // iniciar con botones habilitados
        resetGame(); // aseguramos estado inicial limpio
    })();
</script>
</body>
</html>
